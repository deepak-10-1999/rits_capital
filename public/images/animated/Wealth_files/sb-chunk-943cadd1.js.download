(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["cmd-copyemail"],{"25hB":function(e,t,r){"use strict";r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return a}));var n=r("KmCS"),i=Object(n.regs)("searchux.instrumenter",void 0,{required:!0,tags:["global","deprecated"]}),o=function(){try{var e=i();return e&&e.conversationManager}catch(e){return}};function a(e){try{var t=o(),r=void 0;return{conversationId:(r="serp"===e?t.getLastSubmittedConversation():t.getActiveConversation()).conversationId,logicalId:r.getLogicalSearchId(e)}}catch(e){return{conversationId:void 0,logicalId:void 0}}}},"265C":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("+zb2"),i=r("cDcd");function o(e,t){return function(r,o){var a=t(r,o);return i.createElement(e,Object(n.__assign)({},a))}}},"2rja":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("2CHH");function i(e,t){var r=e.monitorName,i=e.factoryErrorPropExtractor,a=e.successPropExtractor,c=e.failurePropExtractor;return function(e){var s,u=Math.round(performance.now()),d=Object(n.getDispatcher)();function p(e,t){var n=Math.round(performance.now())-u;d.dispatch({eventType:"QOSSTOP",name:"ResponseReceived",result:e,nameDetail:r,startTimestamp:u,totalTime:n,properties:{LogicalId:t.properties&&t.properties.logicalSearchId,ConversationId:t.properties&&t.properties.conversationId,Version:t.version,TraceId:t.traceId,Status:t.status,ProviderName:t.providerName,Latency:n,properties:JSON.stringify(t.properties)}})}d.dispatch({eventType:"QOSSTART",name:"ResponseReceived",nameDetail:r,timestamp:u});try{s=t(e)}catch(e){return p("FAILURE",o(e,i,{status:0,properties:{promiseFactoryFailed:!0}})),Promise.reject(e)}return s.then((function(e){return p("SUCCESS",o(e,a,{status:0,properties:{successExtractorFailed:!0}})),Promise.resolve(e)}),(function(e){return p("FAILURE",o(e,c,{status:0,properties:{failureExtractorFailed:!0}})),Promise.reject(e)}))}}var o=function(e,t,r){try{return(t||a)(e)}catch(e){return r}},a=function(){return{}}},"8btz":function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r("+zb2"),i=r("kKJH"),o=r("a7o/"),a=r("e24R"),c=Object(a.a)("graphMicrosoft"),s=r("KmCS"),u=r("WS+h"),d=Object(u.a)("searchux.graphURLSetting","https://graph.microsoft.com"),p=Object(s.regs)(d.settingName,d.defaultValue);var l,f=(l=[],{getCachedImage:function(e){var t,r;if(void 0===e)return null;try{for(var i=Object(n.__values)(l),o=i.next();!o.done;o=i.next()){var a=o.value;if(a.userId===e)return a.image}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return null},cacheImage:function(e,t){l.some((function(t){return t.userId===e}))||l.push({userId:e,image:t}),l.length>50&&l.shift()}});function h(e){return new Promise((function(t){var r=f.getCachedImage(e);if(r)return t(r);var a=function(e){return"".concat(p(),"/v1.0/users/").concat(e,"/photo/$value")}(Object(o.e)(e));Object(i.a)(c(),(function(e){return{url:a,method:"GET",responseType:"blob",headers:Object(n.__assign)({"Content-Type":"image/jpeg"},e?{Authorization:"Bearer ".concat(e)}:{})}})).subscribe((function(r){if("undefined"!=typeof window){var n,i=window.URL.createObjectURL(r.response);f.cacheImage(e,i),t(i)}else t(r.response?(n=r.response,new Promise((function(e){var t=new FileReader;t.onloadend=function(){return e(t.result)},t.readAsDataURL(n)}))):"")}),(function(){return t("")}))}))}var b=r("G9Vw"),m=r("TBqy"),v=r("lZuS");function g(e){return(Object(b.a)()?h(e):new Promise((function(t,r){try{t(Object(m.b)(m.a.m,e,!1))}catch(e){r(e)}}))).then((function(e){return function(e){if("object"!=typeof window)return!1;var t=new Image;return t.src=e||"",Object(v.a)(t)}(e)?"":e}))}},DphO:function(e,t,r){"use strict";r.r(t);var n=r("+zb2"),i=r("cDcd"),o=r("TkU3"),a=r("4Zy8");t.default=function(e){var t=e.officeLocation,r=o.g({name:e.displayName});return i.createElement(a.a,Object(n.__assign)({ariaLabel:o.d(r,t,!1),captionText:r},e),i.createElement("span",null,t))}},Fh4p:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("+zb2"),i=r("oQ6A");function o(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,r,o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return t=e.split("@")[0],[4,Object(i.a)()({attempt:0})];case 1:return(r=n.sent())?[4,fetch("https://df.loki.delve.office.com/api/v2/person?aadObjectId=".concat(t),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r),"x-clientcorrelationid":"729ebfa9-15ce-4579-ac0e-1598c10a6681","X-ClientType":"OfficeDotCom"}}).then((function(e){return e.json()}))]:[2,null];case 2:return(null==(o=n.sent())?void 0:o.person)&&(null==o?void 0:o.person.userPrincipalName)?[2,o.person.userPrincipalName]:[2,null]}}))}))}},G9Vw:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("KmCS"),i=Object(n.regs)("searchux.isTokenBasedProfileImagesEnabled",!1)},GIWw:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return o})),r.d(t,"a",(function(){return a}));var n=400,i=14,o="600",a="'Segoe UI Semibold WestEuropean', 'Segoe UI Semibold', 'Segoe WP Semibold', 'Segoe UI', 'Segoe WP', Tahoma, Arial, sans - serif"},Ieol:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r("UlRC"),i=r("XgOi"),o=(r("Jvpx"),r("+zb2")),a=r("/hiP"),c=r("nPTt"),s="fetchVRoomSiteAndActivities",u=Object(a.a)((function(e){return Object(c.a)((function(t){var r=t.rootUri,n=t.hostname,i=t.webId,a=t.siteId,c=t.hubSiteId,s=t.isHubSite,u=t.items,d=u.sites,p=u.hub,l=u.site;return{url:s?"".concat(r,"/_api/v2.1/sites?$top=").concat(d,"&$filter=sharepointIds/hubSiteId eq '").concat(c,"'&$expand=activityItems($top=").concat(p,")"):"".concat(r,"/_api/v2.1/sites/").concat(n,",").concat(a,",").concat(i,"?$expand=activityItems($top=").concat(l,")"),method:"GET",headers:Object(o.__assign)(Object(o.__assign)({Accept:"application/json;odata=verbose",Caller:"SearchBox"},s?{}:{Prefer:"BypassSiteAndWebResolution"}),e?{Authorization:"Bearer ".concat(e)}:{})}}))}),{monitorName:s,cacheId:s,cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(e){return{webId:e.webId,siteId:e.siteId,isHubSite:e.isHubSite}}}),d=r("29I4"),p=r("ubpq");const l=/[{}]/g;class f{constructor(e){this.options=e}createStream(e){if(!this.options.site)return n.Observable.empty();const t="news"===this.type?e=>e.news:e=>!e.news,r="site"===this.type?e=>n.Observable.fromArray(e.filter(e=>e.sharepointIds.siteId.toLowerCase()!==this.options.site.siteId.toLowerCase()||e.sharepointIds.webId.toLowerCase()!==this.options.site.webId.toLowerCase())):e=>n.Observable.fromArray(e).selectMany(({activityItems:e})=>n.Observable.fromArray(e.filter(t))),o=(this.options.site.departmentId||this.options.site.siteId).replace(l,""),a=new i.a,c=("news"===this.type||"files"===this.type)&&this.options.site.isHubSite&&Object(p.b)()?h:e=>e;return n.Observable.fromPromise(u({webId:this.options.site.webId,siteId:this.options.site.siteId,rootUri:b(),hostname:m(),isHubSite:this.options.site.isHubSite,hubSiteId:o,items:{sites:100,hub:25,site:100},tokenProvider:this.options.tokenProvider,prefetchTimeSinceOrigin:this.options.now,prefetchUserInfoPuid:this.options.puid,prefetchCacheCollection:this.options.cache,prefetchFetch:this.options.fetch,prefetchDispatch:this.options.dispatch}).then(({xhr:e})=>JSON.parse(e.responseText))).select(e=>"value"in e?e.value:[e]).selectMany(r).propmap(this.propmaps).specFilter(e,a).toArray().select(c).selectMany(e=>n.Observable.fromArray(e))}}function h(e){return e.sort((e,t)=>new Date(t.lastModifiedTime).getTime()-new Date(e.lastModifiedTime).getTime())}function b(){const e=new d.a(window.location.href.toLowerCase());return`${e.getScheme()}://${m(e)}`}function m(e=new d.a(window.location.href.toLowerCase())){return e.getHost()}},KQxh:function(e,t,r){"use strict";r.r(t);var n=r("6JqZ"),i=r("Y66L"),o=r("bwaI");t.default=Object(n.a)(i.a,o.a)},ejkG:function(e,t,r){"use strict";r.r(t);var n=r("+zb2"),i=r("n5ha"),o=r("Fh4p"),a=r("UZl3"),c=r("GPGK"),s=(Object(i.declareString)("search-dl.quickActions.copyEmail.tooltip")),u=Object(c.a)({id:"CopyEmailId",entityType:"People",parameters:[{name:"person",entity:"People",isRequired:!0}],execute:function(e){var t=e.person;return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var e,r,i,a,c;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return e=null===(c=t.value.customProps)||void 0===c?void 0:c.email,i=(r=navigator.clipboard).writeText,(a=e)?[3,2]:[4,Object(o.a)(t.value.id)];case 1:a=n.sent(),n.label=2;case 2:return[2,i.apply(r,[a])]}}))}))},additionalProps:{icon:{iconName:"Copy"},showSuccess:!0,successTooltip:a.b,tooltip:s}});t.default=u},kCs8:function(e,t,r){"use strict";var n=r("pinr"),i=r("rbtW");var o=function(e,t){return Object(n.a)(e,t,(function(t,r){return Object(i.a)(e,r)}))},a=r("sRzR"),c=Object(a.a)((function(e,t){return null==e?{}:o(e,t)}));t.a=c},sRzR:function(e,t,r){"use strict";var n=r("00RH"),i=r("V47J"),o=r("mcBO");t.a=function(e){return Object(o.a)(Object(i.a)(e,void 0,n.a),e+"")}},ubpq:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return a}));var n=r("KmCS");let i;i=i||Object(n.regs)("searchux.sortHubSiteActivities",!1);const o=i,a=Object(n.regs)("searchux.addOneUpQueryParamToVRoomFileUrl",!1)},xDck:function(e,t,r){"use strict";r.r(t);var n=r("+zb2"),i=r("wAGM"),o=r("cDcd"),a=r("dn8U");t.default=Object(i.a)("AdvancedSearchPersonSuggestion")((function(e){var t=e.onClick,r=Object(n.__rest)(e,["onClick"]);return o.createElement(a.default,Object(n.__assign)({},r,{onClick:function(e){e.preventDefault(),null==t||t(e)}}))}))}}]);