(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["pro-3sepa"],{"+e1U":function(e,t,n){"use strict";var r=n("rB4q");var s=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var a=function(e){return this.__data__.has(e)};function i(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r.a;++t<n;)this.add(e[t])}i.prototype.add=i.prototype.push=s,i.prototype.has=a;t.a=i},"3Odw":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("n5ha");const s=(Object(r.declareString)("search-box-container-plugins.searchux.strings.SearchBoxHideableMagnifierSubmitButton.label"))},"6kM1":function(e,t,n){"use strict";var r=n("7k3U"),s=n("lonS"),a=n("sU1h");var i=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},c=Object.prototype.hasOwnProperty;var o=function(e){if(!Object(s.a)(e))return i(e);var t=Object(a.a)(e),n=[];for(var r in e)("constructor"!=r||!t&&c.call(e,r))&&n.push(r);return n},u=n("3AH6");t.a=function(e){return Object(u.a)(e)?Object(r.a)(e,!0):o(e)}},DuRI:function(e,t,n){"use strict";n.r(t);var r=n("6JqZ"),s=n("NaTl"),a=n("4zpW"),i=n("GtFt"),c=n("cDcd"),o=n("R0Os");const u=Object(o.a)(i.s,"suggestion",(function(e,t){var n;const r=(e.label||"").replace("{0}",e.searchText||"");return!e.empty&&e.active?c.createElement(s.a,null,c.createElement("button",{onClick:n=>{var r;return null===(r=e.onAction)||void 0===r||r.call(e,d(t)),e.onClick&&e.onClick(n)},className:null===(n=e.styles)||void 0===n?void 0:n.submitSuggestion},r)):null}));var l=u;const d=Object(a.a)(u,"onClick");var b=n("n5ha");const f=(Object(b.declareString)("search-box-container-plugins.searchux.strings.SubmitSearchSuggestion.moreResults"));var g=n("5sOt");t.default=Object(r.a)(l,g.a,f)},H7xZ:function(e,t,n){"use strict";n.r(t);var r=n("6JqZ"),s=n("GtFt"),a=n("617D"),i=n("sRpU"),c=Object(a.a)({classNames:e=>{var t,n;return e.empty?null===(n=e.styles)||void 0===n?void 0:n.submitSearchButtonInactive:null===(t=e.styles)||void 0===t?void 0:t.submitSearchButton},buttonName:s.j,searchIconContext:{SearchIcon:i.a}}),o=n("3Odw"),u=n("wgER");t.default=Object(r.a)(c,u.a,o.a)},JCJM:function(e,t,n){"use strict";n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return j}));var r=n("+zb2"),s=n("W4Bk");function a(e,t){var n=i();return{iframe:n,initialize:function(){return document.body.contains(n)||(n.src=e,n.style.display="none",document.body.appendChild(n)),n},postMessage:function(r,s,a){var i=function(e,r){return c(n.contentWindow,t,e,r)}(s,a);return n.contentWindow&&n.contentWindow.postMessage(r,e),i}}}var i=function(){return document.createElement("iframe")},c=function(e,t,n,r){return new Promise((function(s,a){return o((function i(c){if(c.source===e&&c.origin===t){var o=void 0,l=!1;try{o=n(c)}catch(e){return u(i),void a(e)}try{l=r(o,c)}catch(e){return u(i),void a(e)}l&&(u(i),s(o))}}))}))},o=function(e){return addEventListener("message",e,!1)},u=function(e){return removeEventListener("message",e,!1)},l=n("LLyz");var d=n("qBZW"),b={},f={},g={};function p(e,t){return b[e]?b[e]:function(e,t,n){if(e){var r=document.getElementById("ms-searchux-3s-proxy"),s=function(e,t){if(e&&e.src===t&&e.ready&&e.postMessage)return{postMessage:e.postMessage,iframe:e,ready:e.ready,initialize:function(){return e}};return null}(r,t);b[n]=s||h(!r,t,n)}else b[n]=h(!1,t,n);return b[n]}((n=window).mssearchux&&n.mssearchux.reuseIframe||!1||t,e+"/search/api/v2/resources",e);var n}function h(e,t,n){var s=a(t,n),i=s.initialize(),o=c(i.contentWindow,n,(function(e){return e.data}),(function(e){return"loaded"===e}));return e&&(i.id="ms-searchux-3s-proxy",i.postMessage=s.postMessage,i.ready=o),Object(r.__assign)(Object(r.__assign)({},s),{ready:o})}var O=function(e,t,n){return void 0===t&&(t="https://substrate.office.com"),void 0===n&&(n=!1),t=Object(d.d)(t),g[t]?v(e,t,n):function(e,t){return void 0===e&&(e="https://substrate.office.com"),void 0===t&&(t=!1),e=Object(d.d)(e),void 0===f[e]&&(f[e]=p(e,t).ready),f[e].then((function(){return g[e]=!0,function(n){return v(n,e,t)}}))}(t,n).then((function(t){return t(e)}))};function v(e,t,n){var r=Object(s.a)(),a=e.action,i=e.token,c=e.prefix,o=e.cvid,u=e.additionalInfo,l=e.headers;return p(t,n).postMessage(JSON.stringify({requestId:r,action:a,token:i,prefix:c,cvid:o,additionalInfo:u,headers:l}),m,(function(e){return e.requestId===r}))}function j(e){var t=JSON.parse(e)[0];t.name;return Object(r.__rest)(t,["name"])}function m(e){try{return JSON.parse(e.data)}catch(e){return Object(l.b)("Failed to parse substrate API JSON response.")}}},Kwpw:function(e,t,n){"use strict";n.r(t);var r=n("6JqZ"),s=n("3Odw"),a=n("GtFt"),i=n("617D"),c=n("sRpU"),o=Object(i.a)({classNames:e=>{var t,n;return e.empty?null===(n=e.styles)||void 0===n?void 0:n.submitSearchButtonInactive:null===(t=e.styles)||void 0===t?void 0:t.submitSearchButton},buttonName:a.c,searchIconContext:{SearchIcon:c.a}}),u=n("Q+ZD"),l=n("YvHQ"),d=n("z+XB"),b=n("PS6g"),f=Object(l.b)(e=>{const t=e.palette.themeDarkAlt;return Object(d.b)({submitSearchButtonInactive:u.a,submitSearchButton:Object.assign(Object.assign({},b.a.IconContainer),{border:"none",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",backgroundColor:"transparent",fill:t,selectors:{":hover":{cursor:"pointer",stroke:t,strokeWidth:"1px",overflow:"visible"}}})})});t.default=Object(r.a)(o,f,s.a)},Lp1E:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var r=n("+zb2"),s=n("CVAo"),a=n("UlRC"),i=n("LLyz"),c=n("xn41"),o=n("nwXE"),u=n("sr/e"),l=n("TNbh"),d=n("qTII"),b=n("fTUD"),f=n("25hB"),g=n("KGPt"),p=n("GFGo"),h=n("2rja"),O=n("kKJH"),v=n("pDa8"),j=n("Fjw7"),m=n("2VtW");function y(e){var t=e.requestExecutor,n=e.searchText,r=e.requestId;return new Promise((function(e){var s=function(){return"object"==typeof window?performance.now():Date.now()},a=s();t.go().then((function(t){if(200!==t.StatusCode)throw JSON.parse(t.Body);e({qfResponse:t.Body,requestId:r,prefix:n,responseHeaders:JSON.stringify(t.Headers),statusCode:t.StatusCode,status:t.StatusCode,clientLatency:Math.round(s())-a})}))}))}function S(e){var t=Object(g.a)(Object(f.c)())||j.a,n="".concat(t,"/search/api/v1/suggestions");return e?"".concat(n,"?clientAppOverride=").concat(e):n}function _(e,t,n){var r=function(e){for(var t=null,r=0;r<n.length;r++){var s=n[r].providers[0];if((null==s?void 0:s.substrateSearchServiceProviderProps.entityType)===e){t=n[r];break}}return t?t.maxCount||t.optimalCount+1:3};return t.map((function(t){return{EntityType:t,Size:r(t),Query:{QueryString:e}}}))}var x=function(e){var t=e.searchText,n=e.entityTypes,f=e.logicalSearchId,g=e.conversationId,j=e.scenario,x=e.appOverride,I=e.suggestionGroups,w=g||Object(s.a)(),P=Object(s.a)(),E=f||Object(s.a)(),N=Object(b.b)();return Object(O.a)(Object(v.b)(),(function(){return{url:S(x),method:"POST"}}),(function(e){var s=e.headers,i=e.url,f={EntityRequests:_(t,n,I),Cvid:w,LogicalId:E,Scenario:{name:j}},g=new u.a(i,"POST",0,!1,JSON.stringify(f),!0);return function(e,t,n,s){var a={Accept:"application/json","Content-Type":"application/json","X-Client-Version":c.a},i=Object(d.b)(),o=Object(l.a)(),u=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},a),t),n&&{"X-AnchorMailbox":n}),{"Client-Request-Id":s}),i&&{"X-Client-Language":i}),o&&{"X-Client-Flights":o});Object.keys(u).forEach((function(t){return e.setHeader(t,u[t])}))}(g,s,N,P),a.Observable.fromPromise(function(e,t){var n=t.requestId,s=t.searchText,a=o.a.current,i=function(e){return Object(p.e)(e,Object(r.__assign)(Object(r.__assign)({},t),{version:a,logDiagnosticsMetrics:Object(b.a)(),clientRequestId:n}))};return Object(h.a)({monitorName:"mssearchux-cache-3sqf",factoryErrorPropExtractor:function(){return{version:a,status:0,properties:{promiseFactoryFailed:!0}}},successPropExtractor:i,failurePropExtractor:i},y)({requestExecutor:e,requestId:n,searchText:s})}(g,{conversationId:w,logicalSearchId:E,anchorMailbox:N,searchText:t,requestId:P})).select((function(e){return Object(r.__assign)(Object(r.__assign)({},e),{prefix:t||"",requestId:P})}))})).select((function(e){var t;try{t=JSON.parse(e.qfResponse)}catch(e){Object(i.b)("Failed to parse JSON")}return Object(r.__assign)(Object(r.__assign)({},Object(p.b)(e,N)),{correlationID:Object(m.a)(t),sprequestduration:"-1",logicalSearchId:E,conversationId:w,body:t})}))}},TNdc:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=t.length,s=e.length;++n<r;)e[s+n]=t[n];return e}},hlAE:function(e,t,n){"use strict";n.r(t),n.d(t,"registration",(function(){return S}));var r=n("+zb2"),s=n("KUM7"),a=n("UlRC"),i=n("rpSO"),c=n("KmCS"),o=n("F6lS"),u=n("FzQG"),l=n("2qGI"),d=n("2VtW"),b=n("POWj"),f=n("TBqy"),g=n("a7o/"),p=n("ohlq"),h=n("xo1z"),O=function(e){return"hierarchy.manager.hops:1"===e},v=n("lbO3"),j=n("q9uV");function m(e){return{displayName:e.DisplayName,userPrincipalName:e.UserPrincipalName||e.EmailAddresses[e.EmailAddresses.length-1],icon:Object(f.b)(f.a.m,e.EmailAddresses[0],!1)}}let y=class{constructor(e,t,n,r){this.searchBox=e,this.config=t,this.fetcher=n,this.conversation=r}getId(){return"AutoSuggestExtractedPeopleAnswerSuggestionProvider"}fetchSuggestionGroups(e){return Object(l.a)({searchText:e,entityTypes:Object(j.b)(this.config,e),scenario:Object(h.a)(Object(p.a)()),appOverride:Object(b.a)(),logicalSearchId:this.conversation&&this.conversation.getLogicalSearchId("sb"),conversationId:this.conversation&&this.conversation.conversationId},Object(u.a)(this.fetcher)).selectMany(e=>a.Observable.fromArray(e.value.body.Groups||[]).where(e=>"People"===e.Type).select(t=>{var n;return Object.assign(Object.assign({},t),{logProps:{traceId:Object(d.a)(e.value.body),entityId:null===(n=t.Suggestions[0])||void 0===n?void 0:n.ReferenceId},originalLogicalSearchId:e.value.logicalSearchId})}))}isValidExtractedPeopleAnswerSuggestionGroup(e){if(!e.Intent)return!1;if(!e.Suggestions||e.Suggestions.length<1)return!1;if("Organization"===e.Intent){if(e.Suggestions.length<2)return!1;let t=!1;for(let n=1;n<e.Suggestions.length;++n){if(t=e.Suggestions[n].PropertyHits.some(O),t)break}if(!t)return!1}return!0}createStream(e){return this.fetchSuggestionGroups(e).where(this.isValidExtractedPeopleAnswerSuggestionGroup).select(t=>{const n=t.Suggestions[0],r={id:"ExtractedPeopleAnswerSuggestion",searchText:e,url:"",displayText:""};switch(t.Intent){case"PhoneNumber":return Object.assign(Object.assign({},r),function(e){var t;const n=Object(v.a)(e.Phones,e=>"Mobile"===e.Type),r=null!=n?n:null===(t=e.Phones)||void 0===t?void 0:t[0];return Object.assign(Object.assign({},m(e)),{kind:"PhoneNumber",phone:r})}(n));case"EmailAddress":return Object.assign(Object.assign({},r),function(e){const t=m(e);return Object.assign(Object.assign({},t),{kind:"EmailAddress",emailAddress:t.userPrincipalName})}(n));case"OfficeLocation":return Object.assign(Object.assign({},r),function(e){return Object.assign(Object.assign({},m(e)),{kind:"OfficeLocation",officeLocation:e.OfficeLocation})}(n));case"Organization":return Object.assign(Object.assign({},r),function(e,t,n){const r=e=>({id:e.Id,searchText:t,url:"",displayText:Object(g.c)([t],e.DisplayName),secondaryDisplayText:Object(g.c)([t],e.JobTitle||""),userUpn:e.UserPrincipalName||e.EmailAddresses[e.EmailAddresses.length-1],displayName:e.DisplayName,icon:Object(f.b)(f.a.m,e.EmailAddresses[0],!1)});for(let t=1;t<n.length;++t){const s=n[t],a="hierarchy.manager.hops:1";if(s.PropertyHits.indexOf(a)>-1)return Object.assign(Object.assign({},m(e)),{kind:"Manager",relatedPerson:r(s)})}}(n,e,t.Suggestions));default:return Object(s.b)(t.Intent,void 0)}})}};y=Object(r.__decorate)([Object(j.a)({entityType:"People"}),Object(r.__param)(0,Object(i.a)("searchBox")),Object(r.__param)(1,Object(i.a)("config")),Object(r.__param)(2,Object(i.a)("fetcher")),Object(r.__param)(3,Object(i.a)("conversation"))],y);t.default=y;const S=Object(c.regs)(o.a+".autosuggestextractedpeopleanswer",y)},uxZc:function(e,t,n){"use strict";t.a=function(e,t){return e.has(t)}}}]);