(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["cpl-answerproviderhost~events-logger~pro-3s-factanswer~pro-3s-factsuggestion~pro-3s-pplkw~pro-3s-uni~a53efe38"],{GFGo:function(e,t,r){"use strict";r.d(t,"b",(function(){return g})),r.d(t,"a",(function(){return y})),r.d(t,"d",(function(){return _})),r.d(t,"e",(function(){return m})),r.d(t,"c",(function(){return O}));var s=r("+zb2"),n=r("CVAo"),o=r("JCJM"),a=r("anwg"),i=r("W4Bk"),c=r("sr/e"),u=r("qBZW");function d(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var r,n,o,a,d,p,h,f,l,v,g,b,y,_,m,O,T,C,j,w,I,q,E,S;return Object(s.__generator)(this,(function(x){switch(x.label){case 0:if(r=Object(i.a)(),n=e.action,o=e.cvid,a=e.prefix,d=e.token,p=e.headers,h=e.useNoBearerAuth,f=e.additionalInfo,!(l=function(e,t){var r=function(e){switch(e){case"getsuggestions":return{path:"suggestions",version:"v1",webMethodType:"GET"};case"init":return{path:"init",version:"v1",webMethodType:"GET"};case"initv2":return{path:"init",version:"v2",webMethodType:"GET"};case"logevents":return{path:"events",version:"v1",webMethodType:"POST"};case"query":return{path:"query",version:"v1",webMethodType:"POST"};case"queryv2":return{path:"query",version:"v2",webMethodType:"POST"};case"adaptiveactions":return{path:"adaptiveactions",version:"v1",webMethodType:"POST"};case"resolveEntitiesAsync":return{path:"resolveEntitiesAsync",version:"v1",webMethodType:"POST"};case"spoquery":return{path:"sharepoint/spoquery",version:"v1",webMethodType:"POST"};case"userConfig":return{path:"userConfig",version:"v1",webMethodType:"POST"};case"unfurl":return{path:"unfurl",version:"v1",webMethodType:"POST"};case"getrecommendations":return{path:"recommendations",version:"v1",webMethodType:"POST"};default:return}}(e);if(r){var s=r.path,n=r.version,o=r.webMethodType,a=Object(u.d)(t);return{url:"".concat(a,"/search/api/").concat(n,"/").concat(s),webMethodType:o}}}(n,t)))throw"No base url found for the given action type";(v=function(e,t,r){var n={};switch(e){case"init":case"initv2":case"query":case"userConfig":t&&(n={cvid:t});break;case"spoquery":t&&(n={correlationId:t});break;case"getsuggestions":t&&(n={cvid:t}),n=Object(s.__assign)(Object(s.__assign)({},n),{query:r||""});break;default:return n}return n}(n,o,a))&&(f=Object(s.__assign)(Object(s.__assign)({},f),v)),g=f&&"1"===f.diagnostics,b=f&&"1"===f.diagnosticsWithoutId,g&&!b&&(f=Object(s.__assign)(Object(s.__assign)({},f),{msgRequestId:r})),y=l.url,_=l.webMethodType,m=function(e,t){if(t)for(var r in t)if(r&&"diagnostics"!==r&&"diagnosticsWithoutId"!==r){var s=e.indexOf("?")>-1?"&":"?";e+="".concat(s).concat(encodeURIComponent(r),"=").concat(encodeURIComponent(t[r]))}return e}(y,f),O=function(e,t,r,s,n,o){var a=new c.a(e,t,0,!1,s,!0);r&&a.setHeader("Authorization",o?r:"Bearer ".concat(r)),a.setHeader("Accept","application/json");var i=!0;if(n)for(var u in n)if(u){var d=u.toUpperCase();d==="Content-Type".toUpperCase()&&(i=!1),d!=="Accept".toUpperCase()&&d!=="Authorization".toUpperCase()&&a.setHeader(u,n[u])}"POST"===t&&i&&a.setHeader("Content-Type","application/json");return a}(m,_,d,a,p,h),x.label=1;case 1:return x.trys.push([1,3,,4]),[4,O.go()];case 2:return T=x.sent(),[3,4];case 3:if((C=x.sent()).midgardError)throw{prefix:a||"",qfResponse:(j=C).responseText||"",requestId:r,responseHeaders:JSON.stringify(j.headers),statusCode:j.statusCode};throw C;case 4:return w={prefix:a||"",qfResponse:T.Body,requestId:r,responseHeaders:JSON.stringify(T.Headers),statusCode:T.StatusCode},g&&performance&&(I=void 0,b?(q=T.Headers&&parseInt(T.Headers["content-length"],10)||0,I=performance.getEntriesByName?performance.getEntriesByName(m,"resource").filter((function(e){return!e.encodedBodySize||!q||e.encodedBodySize===q})).slice(-1):[]):(E=performance.getEntriesByType("resource"),S="".concat("msgRequestId","=").concat(r),I=E.filter((function(e){return e.name.substr(-S.length)===S}))),I&&(w=Object(s.__assign)(Object(s.__assign)({},w),{diagnostics:JSON.stringify(I)}))),[2,w]}}))}))}var p=r("xn41"),h=r("nwXE"),f=r("ozfy"),l=r("2rja");function v(e){try{var t=e.parsedBody;return t.error&&t.error.code}catch(e){return null}}function g(e,t,r){return void 0===r&&(r=!1),Object(s.__assign)(Object(s.__assign)({},b(e,t,r)),{clientLatency:e.clientLatency})}function b(e,t,r){void 0===r&&(r=!1);var s,n=-1,a="Unknown",i="Unknown",c="Unknown",u="Unknown",d="Unknown",p=null,h=""!==t;try{var f=JSON.parse(e.responseHeaders);n=f["x-end2endlatencyms"]||-2,a=f["x-calculatedbetarget"]||"NotProvided",i=f["request-id"]||"NotProvided",c=f["x-msedge-ref"]||"NotProvided",u=f["x-besku"]||"NotProvided",d=f["x-searchplatform"]||"NotProvided"}catch(e){}try{r&&(p=JSON.stringify(Object(o.a)(e.diagnostics)))}catch(e){}return s=function(e){try{var t=e.parsedBody;return t.Instrumentation&&t.Instrumentation.TraceId}catch(e){return null}}(e),{status:e.statusCode,serverLatency:n,serverName:a,requestId:s||i,msEdgeReference:c,anchorMailboxSet:h,xBeSku:u,searchPlatform:d,error:v(e),diagnostics:p}}function y(e,t,r,o,a,i,c){var u=Object(n.a)(),d=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},t&&{Authorization:c?t:"Bearer ".concat(t)}),{"Client-Request-Id":u}),o&&{"X-AnchorMailbox":o}),a&&{"X-Client-Language":a}),i&&{"X-Client-Flights":i}),C()),p=new XMLHttpRequest;return p.open("POST",e,r),Object(f.a)(d,(function(e,t){p.setRequestHeader(t,e)})),t||(p.withCredentials=!0),{xhr:p,headers:d,method:"POST"}}function _(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,r,n,o,a,i,c;return Object(s.__generator)(this,(function(u){return t=e.url,r=e.token,n=e.body,o=e.anchorMailbox,a=e.locale,i=e.substrateSearchClientFlights,c=e.useNoBearerAuth,[2,new Promise((function(e,u){var d=y(t,r,!0,o,a,i,c),p=d.xhr,h=d.headers,f=d.method;p.onload=function(){p.status>=200&&p.status<300?e(Object(s.__assign)({statusCode:p.status},""===p.responseText?{}:JSON.parse(p.responseText))):u(Object(s.__assign)({statusCode:p.status,metadata:{headers:h,method:f,body:n}},""===p.responseText?{}:JSON.parse(p.responseText)))},p.onerror=function(){u("An Unknown Error occurred")},p.send(n)}))]}))}))}function m(e,t){var r=t.anchorMailbox,n=t.version,o=t.clientRequestId,a=t.logicalSearchId,i=t.conversationId,c=b(e,r,t.logDiagnosticsMetrics);return{traceId:c.requestId||o,version:n,status:e.statusCode,properties:Object(s.__assign)(Object(s.__assign)({},c),{logicalSearchId:a,clientRequestId:o,conversationId:i})}}function O(e){var t=e.action,r=e.dataSource,o=e.token,a=e.query,i=e.cvid,c=e.logicalSearchId,u=e.additionalInfo,d=e.additionalHeaders,p=e.anchorMailbox,f=e.locale,v=e.substrateSearchClientFlights,g=e.logDiagnosticsMetrics,b=void 0!==g&&g,y=e.substrateHostName,_=e.substrateHostNameWithIFrame,O=e.useNoBearerAuth,w=e.reuseIframe,I=Object(n.a)(),q=h.a.current,E=function(e){return m(e,{anchorMailbox:p,logDiagnosticsMetrics:b,clientRequestId:I,conversationId:i,logicalSearchId:c,version:q})};return Object(l.a)({monitorName:r,factoryErrorPropExtractor:function(e){return{version:q,status:0,properties:{promiseFactoryFailed:!0}}},successPropExtractor:E,failurePropExtractor:E},T)({action:t,token:o,query:a,cvid:i,logicalSearchId:c,additionalInfo:Object(s.__assign)(Object(s.__assign)({},j(b)),u),additionalHeaders:Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({"Client-Request-Id":I},p&&{"X-AnchorMailbox":p}),f&&{"X-Client-Language":f}),v&&{"X-Client-Flights":v}),C()),d),substrateHostName:y,substrateHostNameWithIFrame:_,useNoBearerAuth:O,reuseIframe:w})}function T(e){var t=e.action,r=e.token,n=e.query,a=e.cvid,i=e.additionalInfo,c=e.substrateHostName,u=e.substrateHostNameWithIFrame,p=e.useNoBearerAuth,h=e.reuseIframe,f={action:t,token:r,prefix:n,cvid:a,additionalInfo:i,headers:Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},C()),e.additionalHeaders),{LogicalId:e.logicalSearchId}),useNoBearerAuth:p};return(c&&!u?d(f,c).catch((function(e){return e})):Object(o.b)(f,c,h)).then((function(e){var t=Object(s.__assign)(Object(s.__assign)({},e),{qfResponse:I(e.qfResponse)});try{t.parsedBody=JSON.parse(t.qfResponse)}catch(e){}if(200!==t.statusCode)throw t;return t}))}function C(){return{Accept:"application/json;odata=verbose","Content-Type":"application/json","X-Client-LocalTime":Object(a.a)(new Date),"X-Client-Version":p.a}}function j(e){return void 0===e&&(e=!1),{diagnostics:e?"1":"0"}}var w=/("DocId"\s*:\s*)(\d+)([,\s}])/gi;function I(e){return e?e.replace(w,'$1"$2"$3'):e}},"sr/e":function(e,t,r){"use strict";var s;r.d(t,"a",(function(){return u})),function(e){e[e.TIMEOUT=0]="TIMEOUT",e[e.CANCELLED=1]="CANCELLED",e[e.FAILED=2]="FAILED"}(s||(s={}));var n="xml-http-request-executor";function o(e){return{family:n,code:e}}var a=/\?/;function i(e,t){return{message:e.status?"":"UndefinedOrAbortedRequestStatus_".concat(t),statusCode:e.status,responseText:"blob"!==e.responseType?e.responseText:void 0,isExpected:!1,shouldRetryAsXhrRequest:!1,headers:c(e.getAllResponseHeaders()),midgardError:o(s.FAILED)}}function c(e){if(e){var t={};return e.split("\r\n").forEach((function(e){var r=e.indexOf(": ");t[e.substr(0,r).toLowerCase()]=e.substr(r+2)})),t}return{}}var u=function(){function e(e,t,r,s,n,o,i){if(void 0===i&&(i="text"),this.url=e,this.verb=t,this.timeout=r,this.body=n,this.withCredentials=o,this.responseType=i,this.isConvertGetPostRequest=!1,this.headers={},s&&"GET"===this.verb){this.isConvertGetPostRequest=!0,this.verb="POST";var c=a.test(this.url);this.url="".concat(this.url).concat(c?"&":"?").concat("ConvertGetPost","=true")}}return e.prototype.setHeader=function(e,t){this.headers[e]=t},e.prototype.setTimeout=function(e){this.timeout=e},e.prototype.go=function(e){var t,r=this;return void 0===e&&(e="REST"),new Promise((function(n,a){var c=new XMLHttpRequest;if(c.open(r.verb,r.url),c.timeout=r.timeout,c.withCredentials=r.withCredentials||!1,r.responseType&&(c.responseType=r.responseType),r.isConvertGetPostRequest)r.body=JSON.stringify(r.headers);else for(var u in r.headers)r.headers.hasOwnProperty(u)&&c.setRequestHeader(u,r.headers[u]);c.onload=function(s){if(c.status>=200&&c.status<300){var o=function(e,t){if(e&&t&&0!==t)return Math.ceil(t-e)}(t,s.timeStamp);n(r.getResponseObjectFromRequest(c,o))}else a(i(c,e))},c.onerror=function(){a(i(c,e))},c.ontimeout=function(){a({statusCode:c.status,message:"RequestTimeout",isExpected:!0,shouldRetryAsXhrRequest:!1,headers:void 0,midgardError:o(s.TIMEOUT)})},c.onabort=function(){a({statusCode:c.status,message:"Cancelled",isExpected:!1,shouldRetryAsXhrRequest:!1,headers:void 0,midgardError:o(s.CANCELLED)})},t=function(){try{if("function"==typeof CustomEvent)return new CustomEvent("Event").timeStamp;if("undefined"!=typeof document)return document.createEvent("Event").timeStamp}catch(e){}}(),c.send(r.body)}))},e.prototype.getResponseObjectFromRequest=function(e,t){return{Body:"blob"===e.responseType?e.response:e.responseText,StatusCode:e.status,Headers:c(e.getAllResponseHeaders()),ResponseUrl:e.responseURL,RequestDurationFromEvents:t}},e}()}}]);